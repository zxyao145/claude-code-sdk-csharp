# Claude Code SDK for C#

A .NET SDK for interacting with Claude through the Claude Code CLI, providing both one-shot queries and interactive client sessions.

## Features

- ✅ **One-shot Queries** - Simple request/response pattern via `ClaudeQuery.QueryAsync`
- ✅ **Interactive Client** - Bidirectional communication with `ClaudeSdkClient`
- ✅ **Streaming Support** - Real-time response streaming
- ✅ **Microsoft Agent Framework Integration** - Use Claude as an `AIAgent` (ClaudeCodeSdk.MAF)
- ✅ **Session Management** - Multi-turn conversations with thread support
- ✅ **Tool Integration** - Support for Claude Code tools and MCP servers
- ✅ **.NET 10.0 Ready** - Built on the latest .NET platform

> [!NOTE]
> This file (README.md) is generated by claude code.

## Installation

### Core SDK

Install via NuGet:

```bash
dotnet add package ClaudeCodeSdk
```

### Microsoft Agent Framework Integration (Optional)

For Microsoft Agent Framework support:

```bash
dotnet add package ClaudeCodeSdk.MAF
```

## Prerequisites

- .NET 10.0 SDK (or .NET 8.0+ for older versions)
- Claude Code CLI: `npm install -g @anthropic-ai/claude-code`

## Quick Start

### One-shot Query

```csharp
using ClaudeCodeSdk;

var messages = ClaudeQuery.QueryAsync("What is the capital of France?");
await foreach (var message in messages)
{
    Console.WriteLine(message.Content);
}
```

### Interactive Client

```csharp
using ClaudeCodeSdk;

using var client = new ClaudeSdkClient();
await client.ConnectAsync();

await client.SendMessageAsync("Hello Claude!");

await foreach (var message in client.ReceiveMessagesAsync())
{
    if (message is AssistantMessage assistantMsg)
    {
        Console.WriteLine($"Claude: {assistantMsg.Content}");
    }
}
```

### Microsoft Agent Framework Integration

```csharp
using ClaudeCodeSdk.MAF;
using Microsoft.Extensions.AI;

// Create Claude as an AIAgent
var agent = new ClaudeCodeAIAgent();

// Simple query
var response = await agent.RunAsync("Explain async/await in C#");
Console.WriteLine(response.Text);

// Multi-turn conversation with thread
var thread = agent.GetNewThread();
var response1 = await agent.RunAsync(
    [new ChatMessage(ChatRole.User, "What is dependency injection?")],
    thread: thread
);

// Context is preserved
var response2 = await agent.RunAsync(
    [new ChatMessage(ChatRole.User, "Show me an example in C#")],
    thread: thread
);
```

See [ClaudeCodeSdk.MAF README](src/ClaudeCodeSdk.MAF/README.md) for complete MAF integration documentation.

## Architecture

The SDK implements a dual-pattern architecture:

- **One-shot Queries** - Fire-and-forget pattern for simple queries
- **Interactive Client** - Long-lived bidirectional communication with session management

### Message Types

- `AssistantMessage` - Claude's responses
- `UserMessage` - User input  
- `SystemMessage` - System notifications
- `ResultMessage` - Conversation end marker

### Content Blocks

- `TextBlock` - Plain text content
- `ToolUseBlock` - Tool invocations
- `ToolResultBlock` - Tool execution results
- `ThinkingBlock` - Claude's reasoning

## Development

### Building

```bash
dotnet build
```

### Testing

```bash
dotnet test
```

### Running Examples

```bash
dotnet run --project examples/
```

### Packaging

```bash
dotnet pack src/ClaudeCodeSdk/ClaudeCodeSdk.csproj -c Release
```

## Available Tools

See the [Claude Code documentation](https://docs.anthropic.com/en/docs/claude-code/settings#tools-available-to-claude) for a complete list of available tools.

## Examples

See the `examples/` folder for complete working examples including:
- Basic queries
- Interactive conversations  
- Tool usage
- Streaming mode

## License

MIT